# Docker Compose for local development/testing
# Usage: docker-compose up

version: '3.8'

services:
  backend:
    build:
      context: .
      dockerfile: backend/Dockerfile
    ports:
      - "8000:8080"
    environment:
      - PORT=8080
      - GOOGLE_SHEETS_CREDENTIALS_PATH=/app/credentials/credentials.json
      - GOOGLE_SHEETS_SPREADSHEET_ID=${GOOGLE_SHEETS_SPREADSHEET_ID}
      - GOOGLE_SHEETS_WORKSHEET_NAME=${GOOGLE_SHEETS_WORKSHEET_NAME:-Leads}
      - GOOGLE_MAPS_API_KEY=${GOOGLE_MAPS_API_KEY}
      - ALLOWED_ORIGINS=http://localhost:3000
    volumes:
      - ./credentials.json:/app/credentials/credentials.json:ro
    restart: unless-stopped

  frontend:
    build:
      context: .
      dockerfile: frontend/Dockerfile
      args:
        - NEXT_PUBLIC_API_URL=http://localhost:8000
    ports:
      - "3000:3000"
    environment:
      - PORT=3000
      - NEXT_PUBLIC_API_URL=http://localhost:8000
    depends_on:
      - backend
    restart: unless-stopped

